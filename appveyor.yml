version: 1.0.{build}

branches:
  only:
    - master
environment:
  nodejs_version: "6"
  priv_key:
    secure: TjloJuZgDACVSn6HIO47+UFQumxbi08N11Z6pK9DQH8Sgv0+JiPZ/3fl6KX48ZC+h7bOTue3Sckm5ChaU8IU0WOwly04eCMP4PGhNq25OC7ygwdy+TJhCPoNoo/IyfaDGVGZrjuVp94wMSQzieqly1bYt3jPGw6iEjB2ph2Dqn++qIX9aZYoD/TKwUo6D++IHgT81KfET/wg8k3ESZNMdvNDcWPbSVydT7ArS1EL8qvu6li06CKe0iXCkg4Llcr7sLb/yMBrCdeaKNXRjdNWSGwi4GDRuqvyNz1jJtHxMajbEnzGsvL3Z8QHK5x3ymlNyjPB4PpfHRNlbp04EhqngFE8WOqW22wQsZ38bI+I0VzbJvGTTB6zYKpLWnbiyne+D7XrK0vBvboum/SAgSFB93DfsEkCYmOZ++lwOiZGJYGdUPh3/Poq9XAa0PTNG9w9Cj3UaonZrFUAJTNCdGrdb9Gnmyyk6D1pupxZc3Yi26pwlzYN+mD8hW9/vrW7TqCsVqnUNYUTxZFAp6UhHDnYJhhqwVUvwQzRTH4rqsGuV/kr+kRnXIEDhPZyVZ+7DjaVwXVtb6FzIX3KcxH5GAHDx1q5q03Tt0ALvMJHE7PC1WMB2v5rpwYudGIxd2iw5+SXFQFP3OHceQGTjLzvGPoK8gIzaT+vkfDLkj+C4MgK9H9NHyzNje/l0rnvKAPd6FAjQC0+qupjABSBKGPS6LklX9/O/CBO33iGSkDCo7zty9oIOUgm1CXfoytOoAAPdsmXoGPfCLT1hheM9WgLCEu1lS43aytcaThOdLjeolZzpyI5CLPSVxYYnAIpCU9azUwdu0hXgLmoUtYGcd7MaGzA5qAX53zO+9/JzdhkzvSDMIpAbVhUbcVWbWJw+kTrCl6kp/jTMKYcmCvzJ83iiuFOh3N23c1q2Js7mDvZnaGjciZG0OYvicKMaPncuURfHQ26XlP8RR4avjhGqlWAqj9ig2lXd2NGQTZvOZyCgqOtBe5dgo12jj6O35Koxz3D0gtSiql6ZwRIvFQK2Dt2ObjjRdwpe8FYjAJtt8YqBoyoQQjFnXCoE9+ly14joZmrpW/Cv0pBEhA2zLXUoAgVjKEpkfSqD4ncGc4zk9JqgnM7BFNsplr7Hhhjh9urUOJ/kFaXfFsM85pKOdWMF+hu7/H1oL0knQsvfN5XsRarVKvEcMInHMlSsnvju6k1BOr2smJfGyHe52cSfiqFaRDUz46NT+jnl6l+V28dHyo/SM9prIs/8V2qNja926Xz5h2OXu2fRBgA02Y20DomSE3ZHuOUeY6sTcieAs6NP+6nU13eqcfJbYAL1moGTjVgkjJ7HAsq94DrsXu32LE0EbDAnOvwgOWdi8aX033bSENJW25/Tg4GNJ6KGjqJDY+lOoBxW9WpfaN6gBL8VwYQShofRMIqPmxEucrVTmhiSMERXU+q8xoBRtFYzbkFneygYuwArgFoNANKZam5RgVqscTNdVGLAZq5U8Ux9/BvmBSjGOSwQlpxQxPjrFMxHUwUK2rqRZRAlacpSRjd9sYl3J/4LPUYwo4gD5fEZuJzXBds8VdM3bjN1Q2IP/rdkpBetGn4+py6BMb3xIC3AED4VHil4iQVrAyLEDOz7PhtuMxhEHKYgm6DkMB5E2IZTQPiwD8OrGyKYYkZuHtvkkNxwRpsTxuKZ5ArTJ3idcLW6rA32pTfN6xcM1AJbixn4om1RJVDVdEhqTN2Bb/h4Yz88fKd7kCMO49pmrUhlYBg/zQPfVFo9rt+PUdIL9RcU5iZ+CipjC7MZGnUti5RMoWd9WubYQIJVS7oMapPR325NxGl5yYRFn99/5OitEVoaGAUsWnFOIF85wQSVA4coq0vKEnUmQ/7Cpfh3oZr/3uutl5VVv5wqqv9BFV2rx06A8JO06ZCUbGF5IGSajh1xMjRU+FFXjHuIYPUDdZU3w4+mWAf8Mzr/He8f/OWnWALXO4QFjn7ijtqDV+iYvvG8D3Fm/aulxmkALOr13xfk3+lHZuiyhjM255ObW9k/lHwj+Cs8yNTdSq/GViD4GDZhm7fLQbQyGLApOUEhcSfHLq5PXxvjYbFJRgdVkETdUfJf+I1N18/1Ld1ckdhzymgTztQtiMweaFqxn2RXyt3gm8QyRBeApuWKVI=

install:
  - npm install
  - npm install elm -g 
  - npm install webpack -g 
  - elm-package install --yes
  - ps: $fileContent = "-----BEGIN RSA PRIVATE KEY-----`n"
  - ps: $fileContent += $env:priv_key.Replace(' ', "`n")
  - ps: $fileContent += "`n-----END RSA PRIVATE KEY-----`n"
  - ps: Set-Content c:\users\appveyor\.ssh\id_rsa $fileContent
  - ps: Get-Content c:\users\appveyor\.ssh\id_rsa

build_script:
  - webpack --config webpack.config.prod.js

on_success:
  - cd dist
  - ps: ls
  - git init
  - git add .
  - git status
  - git commit -m "New release"
  - git remote add deploy ssh://ci@46.101.41.13/home/ci/code/sensor-frontend
  - git push deploy master